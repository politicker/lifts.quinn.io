<!DOCTYPE html>
<html>
  <head>
    <title>{{.Title}}</title>
    <link rel="stylesheet" href="/static/css/index.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script>
      window.DATA = JSON.parse("{{.Lifts}}");
    </script>

    <script type="module">
      import * as d3 from "https://cdn.jsdelivr.net/npm/d3@7/+esm";

      d3.scaleLinear()
        .domain([0, d3.max(window.DATA)])
        .range([0, 100]);

      const holder = d3.select(".frame");
      holder
        .selectAll(".lift")
        .data(window.DATA)
        .join("div")
        .attr("class", "lift")
        .each(function (d) {
          const height = d3
            .scaleLinear()
            .domain(d3.extent(d.History))
            .range([20, 100]);

          const n = d3.select(this);

          n.append("h3").text(d.Name);
          n.append("p").text(d.BestSet);

          n.append("div")
            .attr("class", "graph")
            .selectAll(".bar")
            .data(d.History)
            .join("div")
            .attr("class", "bar")
            .style("height", (d) => `${height(d)}px`);
        });
    </script>
  </head>
  <body>
    <div class="frame"></div>
  </body>
</html>
